# 三次元空間における三角形の法線ベクトル計算（Python）

本リポジトリでは、三次元空間上の3点からなる三角形に対して、
**法線ベクトルを求める数値計算手法**を Python により実装し、
手動実装と数値計算ライブラリによる実装の比較を行う。

数学的定義に基づく基本的な実装と、
NumPy を用いた高速なベクトル化実装を比較することで、
数値計算ライブラリの有効性を確認することを目的とする。

---

## 概要

三角形の法線ベクトルは、計算幾何学、コンピュータグラフィックス、
物理シミュレーションなど多くの分野で利用される基本的な概念である。

本リポジトリでは以下を行う。

- 数学的定義に基づく法線ベクトル計算の実装
- NumPy を用いたライブラリ実装
- 大量データに対する実行速度の比較
- 三次元空間での幾何的な理解を補助する可視化

---

## 動作環境

* Python 3.x
* NumPy
* Matplotlib（可視化用）

必要なライブラリは以下でインストールできる。

```bash
pip install numpy matplotlib
```

---

## 注意事項

* 浮動小数点演算のため、計算結果には微小な誤差が含まれる場合がある
* 法線ベクトルの向きは、点の並び順に依存する（右手系）

---

## 数学的背景

三次元空間上の3点を以下のように定義する。

- 点 A  
- 点 B  
- 点 C  

これらの点から、2つの辺ベクトルを定義する。

```math
\vec{AB} = \vec{B} - \vec{A} \
\vec{AC} = \vec{C} - \vec{A}
```

三角形の法線ベクトルは、これら2つの辺ベクトルの外積として求められる。

```math
\vec{n} = \vec{AB} \times \vec{AC}
```

成分表示すると、以下のようになる。

```math
\vec{AB} = (a_1, a_2, a_3),\quad
\vec{AC} = (b_1, b_2, b_3)
```

```math
\vec{n} =
(
a_2 b_3 - a_3 b_2,\
a_3 b_1 - a_1 b_3,\
a_1 b_2 - a_2 b_1
)
```

この成分計算をそのままプログラムに落とし込んだものが手動実装である。

---

## ファイル構成

```text
.
├── 0_data.py        サンプルデータ（CSV）生成用スクリプト
├── 1_manual.py      法線ベクトル計算（手動実装）
├── 1_library.py     法線ベクトル計算（NumPy使用）
├── 2_manual.py      実行速度比較（手動実装）
├── 2_library.py     実行速度比較（NumPy使用）
├── 3_visualize.py   三角形と法線ベクトルの可視化
├── data.csv         三角形データ（入力用）
└── README.md
```

---

## 使用方法

### 1. サンプルデータの生成

三角形データを CSV ファイルとして生成する。

```bash
python 0_data.py
```

`data.csv` が生成（または上書き）される。

---

### 2. 法線ベクトルの計算（単一データ）

#### 手動実装

```bash
python 1_manual.py
```

#### NumPy を用いた実装

```bash
python 1_library.py
```

どちらも同一の入力データに対して法線ベクトルを計算する。

---

### 3. 実行速度比較（大量データ）

#### 手動実装

```bash
python 2_manual.py
```

#### NumPy を用いた実装

```bash
python 2_library.py
```

各プログラムの実行時間が標準出力に表示される。

---

### 4. 可視化（3次元表示）

三角形およびその法線ベクトルを、三次元空間上で可視化することで、
計算結果を幾何的に確認することができる。

可視化では以下の要素を表示する。

- 三角形の頂点 A, B, C
- 三角形 ABC の面
- 三角形に垂直な法線ベクトル \(\vec{n}\)
- X軸、Y軸、Z軸（色分け表示）

可視化用スクリプトを実行すると、三次元プロットが表示される。

```bash
python visualize.py
```

図中では、

* 黒点が三角形の頂点 A, B, C を表す
* 半透明の面が三角形 ABC を表す
* 赤い矢印が法線ベクトル (\vec{n}) を表す
* X軸は赤、Y軸は緑、Z軸は青で表示される

これにより、法線ベクトルが三角形の面に対して垂直であることを
視覚的に確認できる。

---

## 実行速度比較について

手動実装では Python の for ループを用いて
三角形を1つずつ処理するため、データ数の増加に伴い
実行時間が大きく増加する。

一方、NumPy を用いた実装では配列全体に対して
一括で演算を行うため、内部で最適化された
C 言語ベースの計算が実行され、高速な処理が可能となる。

この違いにより、大規模データでは
NumPy 実装が大幅に高速になることが確認できる。

---

## 可視化について

三角形およびその法線ベクトルは、
`matplotlib` の三次元プロット機能を用いて可視化できる。

可視化を行うことで、計算された法線ベクトルが
三角形の面に対して垂直であることを
直感的に確認することができる。